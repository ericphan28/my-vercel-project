import { useState, useEffect } from "react"; import { supabase } from "../lib/supabase"; export default function Home() { const [todos, setTodos] = useState([]); const [task, setTask] = useState(""); const [user, setUser] = useState(null); useEffect(() => { supabase.auth.getUser().then(({ data }) => setUser(data.user)); fetchTodos(); }, []); async function fetchTodos() { const { data } = await supabase.from("todos").select("*").eq("user_id", user?.id); setTodos(data || []); } async function addTodo() { if (!task || !user) return; await supabase.from("todos").insert([{ task, user_id: user.id }]); setTask(""); fetchTodos(); } async function deleteTodo(id) { await supabase.from("todos").delete().eq("id", id); fetchTodos(); } async function login() { await supabase.auth.signInWithPassword({ email: "ericphan28@gmail.com", password: "Tnt@9961266" }); window.location.reload(); } async function logout() { await supabase.auth.signOut(); window.location.reload(); } return ( <div style={{ padding: "20px" }}> {user ? ( <> <h1>Xin chào, {user.email}</h1> <button onClick={logout}>Đăng xuất</button> <h2>Todo List</h2> <input value={task} onChange={(e) => setTask(e.target.value)} placeholder="Nhập công việc" /> <button onClick={addTodo}>Thêm</button> <ul> {todos.map((todo) => ( <li key={todo.id}> {todo.task} <button onClick={() => deleteTodo(todo.id)}>Xóa</button> </li> ))} </ul> </> ) : ( <> <h1>Đăng nhập để dùng Todo List</h1> <button onClick={login}>Đăng nhập</button> </> )} </div> ); }
